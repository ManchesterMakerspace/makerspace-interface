app.factory('slackService', function(){

  var socket;

  var connect = function(){
    socket = io.connect("https://masterslacker.herokuapp.com/");
    socket.on('connect', function(){
      socket.emit('authenticate', {
        token: '<%=Rails.application.secrets.slack_variable%>',
        goodBye: 'Interface connection closed.',
        slack: {
          username: 'Management Bot',
          channel: 'master_slacker',
          iconEmoji: ':ghost:'
        }
      });
    });
  };

  var invite = function(email, fullname) {
    socket.emit('invite', email);
    var msg = 'New member ' + fullname + ' invited to Slack!';
    socket.emit('channelMsg', {channel: 'whos_at_the_space', msg: msg});
  };

  var disconnect = function(){
    socket.disconnect();
  };

  return {
    socket: socket,
    connect: connect,
    invite: invite,
    disconnect: disconnect
  };
});
